<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>ECharts</title>
    <!-- 引入刚刚下载的 ECharts 文件 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <script src="../ajax.js"></script>
</head>

<body>
    <!-- 为 ECharts 准备一个定义了宽高的 DOM -->
    <div id="main1" style="width: 600px;height:400px;"></div>
    <div id="main2" style="width: 600px;height:400px;"></div>
    <div id="main3" style="width: 600px;height:400px;"></div>
    <script type="text/javascript">

        ajax({
            method: 'get',
            url: '://www.nmc.cn/rest/weather',
            data: {
                stationid: 54857,
                _: 1692944434612
            },
            success: function (a) {
                console.log(a.data.passedchart);
                console.log(a.data.predict.detail);
                console.log(a.data.tempchart);
                var wd24 = []//24小时内温度变化   temperature 为温度，time为时间，顺序为今天到昨天
                for (let i = 0; i < a.data.passedchart.length; i++) {
                    wd24.unshift(a.data.passedchart[i])
                }
                var wd5 = []//5天内温度情况    date为时间   day.weather.temperature为白天温度   night.weather.temperature为晚上温度
                for (let i = 0; i < 5; i++) {
                    wd5.push(a.data.predict.detail[i])

                }
                var mwd5 = []//5天最高温最低温   max_temp  最高温   ，min_temp   最低温   time 时间
                for (let i = 0; i < 5; i++) {
                    mwd5.push(a.data.tempchart[i])

                }
                // 基于准备好的dom，初始化echarts实例
                var myChart1 = echarts.init(document.getElementById('main1'));
                // 指定图表的配置项和数据
                var option = {
                    title: {
                        text: '24小时内温度变化'
                    },
                    tooltip: {},
                    legend: {
                        show: false
                    },
                    xAxis: {
                        data: wd24.map(a => a.time)
                    },
                    yAxis: {},
                    series: [
                        {
                            name: '温度',
                            type: 'line',
                            data: wd24.map(a => a.temperature)
                        }
                    ]
                };
                // 使用刚指定的配置项和数据显示图表。
                myChart1.setOption(option);

                var myChart2 = echarts.init(document.getElementById('main2'));
                // 指定图表的配置项和数据
                var option = {
                    title: {
                        text: '5天内温度情况'
                    },
                    tooltip: {},
                    legend: {
                        data: ['白天温度', '夜间温度']
                    },
                    xAxis: {
                        data: wd5.map(a => a.date)
                    },
                    yAxis: {},
                    series: [
                        {
                            name: '白天温度',
                            type: 'bar',
                            data: wd5.map(a => a.day.weather.temperature)
                        }, {
                            name: '夜间温度',
                            type: 'bar',
                            data: wd5.map(a => a.night.weather.temperature)
                        }
                    ]
                };
                // 使用刚指定的配置项和数据显示图表。
                myChart2.setOption(option);



                var myChart3 = echarts.init(document.getElementById('main3'));
                // 指定图表的配置项和数据
                var option = {
                    title: {
                        text: '5天内最高最低温度情况'
                    },
                    tooltip: {},
                    legend: {
                        data: ['最高温度', '最低温度']
                    },
                    xAxis: {
                        data: mwd5.map(a => a.time)
                    },
                    yAxis: {},
                    series: [
                        {
                            name: '最高温度',
                            type: 'bar',
                            data: mwd5.map(a => a.max_temp)
                        }, {
                            name: '最低温度',
                            type: 'bar',
                            data: mwd5.map(a => a.min_temp)
                        }
                    ]
                };
                // 使用刚指定的配置项和数据显示图表。
                myChart3.setOption(option);
            }

        })


    </script>
</body>

</html>